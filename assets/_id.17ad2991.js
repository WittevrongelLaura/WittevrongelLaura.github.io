import{p as U,y as X,u as $,k as q,s as J,l as V,i as M,G as H,_ as Q,r as g,o as n,d as x,w as D,c as u,a as t,t as m,b as k,B as z,C as E,x as Y,e as C,F as T,m as R,n as K}from"./index.8c7fcc53.js";import{R as W}from"./RouteHolder.8957e64c.js";import{u as Z}from"./useSocket.4eb3b914.js";import{c as G}from"./createVueComponent.12d7077d.js";import{X as ee}from"./x.752848a9.js";import{T as te}from"./trash-2.acf5b66a.js";var re=G("ArrowLeftIcon",[["line",{x1:"19",y1:"12",x2:"5",y2:"12",key:"17g05t"}],["polyline",{points:"12 19 5 12 12 5",key:"1ksm0z"}]]);const se=re;var oe=G("CheckIcon",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);const ne=oe,ae=U`
    query transportsById($checklistId: String!) {
        transportsByChecklistId(checklistId: $checklistId) {
            id
            driver
            amountOfSeats
            people{
                id
                uid
                name
                role
                createdAt
                updatedAt
            }
        }
    }
`,le={components:{RouteHolder:W,X:ee,Trash2:te,Check:ne,ArrowLeft:se},setup(){var e,f;const{params:a}=X(),{user:o}=$(),b=q(!1),r=J({checklistId:a.id,driver:(e=o.value)==null?void 0:e.displayName,amountOfSeats:4,people:[]}),{result:w}=V(H),{connectToServer:I,connected:v,disconnectFromServer:S,socketServer:l}=Z();I(),M(v,()=>{v.value==!1?S():(I(),console.log("connection made "))}),(f=l.value)==null||f.on("transport:gettransports",i=>{h.value={transportsByChecklistId:i}});const B=async(i,c)=>{var p,N,j,F;let s=JSON.parse(JSON.stringify(c));for(let y of(p=w.value)==null?void 0:p.users)y.uid==((N=o.value)==null?void 0:N.uid)&&(s==null||s.push(y));const d={id:i,user:s,checklistId:a.id};(j=l.value)==null||j.emit("transport:addPassenger",d),(F=l.value)==null||F.on("transport:gettransports",y=>{h.value={transportsByChecklistId:y}})},_=i=>{var s,d,p;const c={id:i,uid:(s=o.value)==null?void 0:s.uid,checklistId:a.id};(d=l.value)==null||d.emit("transport:removePassenger",c),(p=l.value)==null||p.on("transport:gettransports",N=>{})},P=i=>{var c,s,d;(c=l.value)==null||c.emit("transport:deletetransport",i),(s=l.value)==null||s.emit("transport:gettransports",a.id),(d=l.value)==null||d.on("transport:gettransports",p=>{h.value={transportsByChecklistId:p}})},{result:h,error:A,loading:O}=V(ae,{checklistId:a.id});return{result:h,transportInput:r,createCarpool:b,user:o,users:w,deleteCarpool:P,addPassenger:B,deletePassenger:_,submitForm:async()=>{var i,c,s;b.value=!1,(i=l.value)==null||i.emit("transport:createtransport",r),(c=l.value)==null||c.emit("transport:gettransports",a.id),(s=l.value)==null||s.on("transport:gettransports",d=>{h.value={transportsByChecklistId:d}})}}}},ie={key:0,class:"absolute z-50 bottom-0 right-0 h-full w-full bg-white/70"},ce={class:"flex justify-between"},de={class:"mb-2 text-2xl font-medium"},ue={class:"mt-6"},pe={class:"flex gap-1"},me=t("h2",{class:"text-xl"},"Driver:",-1),he={class:"flex text-lg items-center gap-2"},ge=t("p",null,"Seats:",-1),ve=t("div",{class:"float-right mt-5"},[t("button",{class:"bg-greenPrimary hover:bg-green700 rounded-full py-1 px-4 text-white"},[t("p",null,"Create")])],-1),fe={class:"items-center"},ke=t("h1",{class:"font-theme flex justify-center text-4xl font-bold text-green-700"}," Carpool ",-1),_e={class:"flex justify-center"},ye={class:"flex"},xe={key:0},Ce=t("p",{class:"text-neutral-500"},"Geen",-1),be=[Ce],we={class:"border-1 w-min border-greenPrimary rounded-2xl px-2"},Ie={key:1,class:"mt-6 text-center text-neutral-500"},Se={class:"flex p-1 font-semibold text-white"},Be={class:"pl-1"};function Pe(a,o,b,r,w,I){const v=g("X"),S=g("ArrowLeft"),l=g("RouterLink"),B=g("Trash2"),_=g("Check"),P=g("Plus"),h=g("route-holder");return n(),x(h,{class:"min-h-screen"},{default:D(()=>{var A,O,L;return[r.createCarpool?(n(),u("div",ie,[t("form",{onSubmit:o[3]||(o[3]=Y((...e)=>r.submitForm&&r.submitForm(...e),["prevent"])),class:"bg-green100 text-green900 absolute top-[40%] left-[15%] right-[15%] md:left-1/3 md:right-1/3 lg:left-2/5 lg:right-2/5 rounded-xl p-4 shadow-lg"},[t("div",ce,[t("h1",de,m(a.$t("carpool.newCarpool")),1),k(v,{class:"hover:cursor-pointer",onClick:o[0]||(o[0]=e=>r.createCarpool=!1)})]),t("div",ue,[t("div",pe,[me,z(t("input",{class:"mb-2 text-xl bg-transparent","onUpdate:modelValue":o[1]||(o[1]=e=>r.transportInput.driver=e)},null,512),[[E,r.transportInput.driver]])]),t("div",he,[ge,z(t("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=e=>r.transportInput.amountOfSeats=e),class:"h-auto w-6 rounded-lg border-green-700 bg-transparent outline-none"},null,512),[[E,r.transportInput.amountOfSeats]])])]),ve],32)])):C("",!0),t("div",fe,[k(l,{to:"/trips",class:"float-left absolute"},{default:D(()=>[k(S,{class:"h-10 w-10"})]),_:1}),ke]),t("div",_e,[((A=r.result)==null?void 0:A.transportsByChecklistId.length)!==0?(n(),u("ul",{key:0,class:K(`mt-8 grid sm:grid-cols-${(O=r.result)==null?void 0:O.transportsByChecklistId.length.toString()} items-center justify-center gap-8`)},[(n(!0),u(T,null,R((L=r.result)==null?void 0:L.transportsByChecklistId,e=>{var f,i,c;return n(),u("li",{key:e.id,class:"h-auto w-56 sm:w-44 rounded-xl bg-white p-4 shadow-lg"},[k(B,{onClick:s=>r.deleteCarpool(e.id),class:"float-right flex text-red-600 hover:cursor-pointer hover:text-red-800"},null,8,["onClick"]),t("h1",null,m(a.$t("carpool.driver"))+": "+m(e.driver),1),t("p",null,m(a.$t("carpool.seats"))+": "+m(e.amountOfSeats),1),t("p",null,m(a.$t("carpool.passengers"))+":",1),t("div",ye,[((f=e.people)==null?void 0:f.length)==0?(n(),u("div",xe,be)):C("",!0),((i=e.people)==null?void 0:i.length)==0&&e.driver!=((c=r.user)==null?void 0:c.displayName)&&e.amountOfSeats>e.people.length?(n(),x(_,{key:1,onClick:s=>r.addPassenger(e.id,e.people),class:"text-greenPrimary mr-0 ml-auto hover:cursor-pointer hover:text-green900"},null,8,["onClick"])):C("",!0),(n(!0),u(T,null,R(e.people,s=>(n(),u("div",{class:"grid grid-cols-1 items-center gap-1",key:s.id},[t("p",we,m(s.name),1)]))),128)),(n(!0),u(T,null,R(e.people,s=>{var d;return n(),u("div",{class:"mr-0 ml-auto mb-0 mt-auto",key:s.id},[s.uid==((d=r.user)==null?void 0:d.uid)?(n(),x(v,{key:0,onClick:p=>r.deletePassenger(e.id),class:"text-red-400 hover:cursor-pointer hover:text-red-600"},null,8,["onClick"])):e.amountOfSeats>e.people.length?(n(),x(_,{key:1,onClick:p=>r.addPassenger(e.id,e.people),class:"text-greenPrimary hover:cursor-pointer hover:text-green900"},null,8,["onClick"])):C("",!0)])}),128))])])}),128))],2)):(n(),u("p",Ie,m(a.$t("carpool.noCarpools")),1))]),t("button",{onClick:o[4]||(o[4]=e=>r.createCarpool=!0),class:"bg-greenPrimary hover:bg-green700 float-right mt-8 w-max rounded-full py-3 px-3"},[t("div",Se,[k(P),t("p",Be,m(a.$t("carpool.createNew")),1)])])]}),_:1})}const je=Q(le,[["render",Pe]]);export{je as default};
