import{q as A,k as O,u as G,s as V,v as B,G as z,_ as E,r as C,o as a,c as r,a as e,t as n,b as f,F as I,m as S,x as R,e as _,n as X,w as N}from"./index.8c7fcc53.js";import{u as D}from"./useSocket.4eb3b914.js";import{T as H}from"./trash-2.acf5b66a.js";import{P as M}from"./plus.d021a9a1.js";import{c as j}from"./createVueComponent.12d7077d.js";import{X as W}from"./x.752848a9.js";var Q=j("CarIcon",[["path",{d:"M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2",key:"l5np60"}],["circle",{cx:"6.5",cy:"16.5",r:"2.5",key:"ae40ju"}],["circle",{cx:"16.5",cy:"16.5",r:"2.5",key:"1smtlt"}]]);const K=Q;var Y=j("Share2Icon",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49",key:"10dsx0"}],["line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49",key:"1qn9hm"}]]);const Z=Y,$={components:{Trash2:H,Plus:M,Share2:Z,X:W,Car:K},props:{checklists:{type:Array,required:!0},shared:{type:Boolean}},setup(c){var T,J,P;const{result:u,loading:h,error:i}=A(z),v=O(""),{user:g}=G(),m=O(c.checklists),b=O(!1),F=V({name:"Untitled",description:"Description...",userId:(T=g.value)==null?void 0:T.uid,sharedUserIds:[],categories:[{name:"Category",list:[{name:"Item",check:!1}]}]}),U=t=>/\s/g.test(t),{socketServer:k}=D(),x=()=>{var t,l,o;(l=k.value)==null||l.emit("checklist:getchecklists",(t=g.value)==null?void 0:t.uid),(o=k.value)==null||o.on("checklist:getchecklists",d=>{m.value=d})};return c.shared===!1&&((J=k.value)==null||J.emit("user:getusers"),(P=k.value)==null||P.on("user:getusers",t=>{var l;for(let o of t)o.role==="admin"&&t.splice(t.indexOf(o),1),o.uid===((l=g.value)==null?void 0:l.uid)&&t.splice(t.indexOf(o),1);u.value={users:t}}),x()),{checklistId:v,clickShare:b,result:u,checklistsList:m,getChecklists:x,addSharedFriend:t=>{var o;const l=JSON.parse(t.target.value);m.value=JSON.parse(JSON.stringify(m.value));for(let d of m.value)(o=d.sharedUserIds)!=null&&o.includes(l.uid)||d.sharedUserIds.push(l.uid)},deleteSharedFriend:t=>{var l;m.value=JSON.parse(JSON.stringify(m.value));for(let o of m.value)o.sharedUserIds=(l=o.sharedUserIds)==null?void 0:l.filter(d=>t!==d)},buttonAddSharedFriends:async()=>{var o,d;let t;for(let w of m.value)w.id===v.value&&(t=w.sharedUserIds);let l={ids:{id:v.value,sharedUserIds:t},userId:(o=g.value)==null?void 0:o.uid};(d=k.value)==null||d.emit("checklist:updatesharedfriends",l),b.value=!1},totalOfSharedIds:t=>{let l=0;for(let o=0;o<t.length;o++)l+=1;return l},GetNameOfUserId:t=>{var o;const l=(o=u.value)==null?void 0:o.users.find(d=>d.uid===t);return l==null?void 0:l.name},totalofItemsCheckedInCategory:t=>{let l=0;if(t!=null)for(let o=0;o<t.length;o++)for(let d=0;d<t[o].list.length;d++)t[o].list[d].check&&(l+=1);return l},totalItemsInCategory:t=>{let l=0;if(t!=null)for(let o=0;o<t.length;o++)l+=t[o].list.length;return l},removeChecklist:async t=>{var l;(l=k.value)==null||l.emit("checklist:deletechecklist",t,g.value.uid),x()},addChecklist:async()=>{var t,l;(t=k.value)==null||t.emit("checklist:createchecklist",F),(l=k.value)==null||l.on("checklist:getchecklist",o=>{v.value=o.id,o.id&&B.push(`/trips/${o.id}`)})},containsWhiteSpace:U,submitForm:async()=>{var o,d;let t;for(let w of m.value)w.id===v.value&&(t=w.sharedUserIds);let l={ids:{id:v.value,sharedUserIds:t},userId:(o=g.value)==null?void 0:o.uid};(d=k.value)==null||d.emit("checklist:updatesharedfriends",l),b.value=!1}}}},ee={key:0,class:"absolute bottom-0 right-0 z-50 h-full w-full bg-white/70"},te={class:"flex justify-between"},se={class:"mb-2 text-lg font-medium md:text-2xl"},oe={disabled:"",selected:"",value:"Choose a friend"},le=["value"],ae={class:"mb-1"},re={key:0,class:"w-min items-center"},ie={key:0,class:"border-1 border-green900 flex gap-1 rounded-2xl px-2"},ne={key:0},de=e("div",{class:"h-[26.23px]"},null,-1),ce=[de],he={class:"float-right"},ue={class:"bg-greenPrimary hover:bg-green700 rounded-full py-1 px-4 text-white"},me={class:"hidden w-full lg:table"},fe={class:"p-3 text-left"},_e={class:"p-3 text-left"},ke={class:"p-3"},ve={class:"p-3"},ge={key:0,class:"p-3"},ye={key:1,class:"p-3"},pe={key:0},Ce={class:"p-3"},be={key:0},xe={key:1,class:"overflow-hidden truncate whitespace-nowrap"},Ie={class:"p-3"},we={class:"max-w-50 overflow-hidden truncate whitespace-nowrap"},Se={class:"text-center"},Fe={class:"w-[90px] text-center"},Ue={key:0,class:"mt-[10px] w-[90px] text-center"},Ne=["onClick"],Oe={key:1,class:"mt-[10px] w-[90px] text-center"},Le=["onClick"],Te={class:"grid w-full pl-3 text-left"},Je={key:1,class:"text-neutral-500"},Pe={class:"lg:hidden"},je={class:"flex justify-between"},qe={class:"p-3"},Ae={class:"w-32 truncate whitespace-nowrap font-semibold"},Ge={class:"w-32 truncate whitespace-nowrap text-neutral-500"},Ve={class:"p-3 font-bold"},Be={class:"flex justify-end"},ze={class:"flex items-center gap-2 p-3"},Ee=["onClick"],Re=["onClick"],Xe={class:"flex p-1 font-semibold text-white"},De={class:"hidden pl-1 md:inline"};function He(c,u,h,i,v,g){const m=C("X"),b=C("RouterLink"),F=C("Car"),U=C("router-link"),k=C("Share2"),x=C("Trash2"),L=C("Plus");return a(),r(I,null,[i.clickShare?(a(),r("div",ee,[e("form",{onSubmit:u[2]||(u[2]=R((...s)=>i.submitForm&&i.submitForm(...s),["prevent"])),class:"bg-green100 text-green900 lg:left-2/5 lg:right-2/5>>>>>> absolute top-[40%] left-[15%] right-[15%] rounded-xl p-4 shadow-lg md:left-1/3 md:right-1/3"},[e("div",te,[e("h1",se,n(c.$t("share.title")),1),f(m,{class:"hover:cursor-pointer",onClick:u[0]||(u[0]=s=>i.clickShare=!1)})]),e("div",null,[e("select",{onChange:u[1]||(u[1]=s=>i.addSharedFriend(s)),class:"my-2 bg-transparent",name:"cars",id:"cars"},[e("option",oe,n(c.$t("share.chooseFriend")),1),(a(!0),r(I,null,S(i.result.users,s=>(a(),r("option",{value:JSON.stringify(s),key:s.id},n(s.name),9,le))),128))],32)]),e("div",null,[e("p",ae,n(c.$t("share.sharingFriends"))+":",1),(a(!0),r(I,null,S(i.checklistsList,s=>{var y;return a(),r("ul",{class:"flex gap-2",key:s.id},[s.id===i.checklistId?(a(),r("li",re,[(a(!0),r(I,null,S(s.sharedUserIds,p=>(a(),r("div",{key:p},[p?(a(),r("div",ie,[e("p",null,n(i.GetNameOfUserId(p)),1),f(m,{class:"w-3 pt-[2px] hover:cursor-pointer",onClick:q=>i.deleteSharedFriend(p)},null,8,["onClick"])])):_("",!0)]))),128)),((y=s.sharedUserIds)==null?void 0:y.length)===0?(a(),r("div",ne,ce)):_("",!0)])):_("",!0)])}),128))]),e("div",he,[e("button",ue,[e("p",null,n(c.$t("table.share")),1)])])],32)])):_("",!0),e("table",me,[e("tr",null,[e("th",fe,n(c.$t("table.name")),1),e("th",_e,n(c.$t("table.description")),1),e("th",ke,n(c.$t("table.completed")),1),e("th",ve,n(c.$t("table.carpool")),1),h.shared?_("",!0):(a(),r("th",ge,n(c.$t("table.share")),1)),h.shared?_("",!0):(a(),r("th",ye,n(c.$t("table.delete")),1))]),h.checklists.length>0?(a(),r("tbody",pe,[(a(!0),r(I,null,S(h.checklists,(s,y)=>(a(),r("tr",{key:s.id,class:X([y%2===0?"bg-green50":"","overflow-hidden rounded-md"])},[e("td",Ce,[f(b,{to:`/trips/${s.id}`},{default:N(()=>[i.containsWhiteSpace(s.name)?(a(),r("p",be,n(s.name),1)):(a(),r("p",xe,n(s.name),1))]),_:2},1032,["to"])]),e("td",Ie,[e("p",we,n(s.description),1)]),e("td",Se,[e("p",null,n(`${i.totalofItemsCheckedInCategory(s.categories)}/${i.totalItemsInCategory(s.categories)}`),1)]),e("td",Fe,[f(U,{class:"",to:`/carpool/${s.id}`},{default:N(()=>[e("button",null,[f(F,{class:"fh-8 w-8"})])]),_:2},1032,["to"])]),h.shared?_("",!0):(a(),r("td",Ue,[h.shared?_("",!0):(a(),r("button",{key:0,onClick:p=>{i.clickShare=!0,i.checklistId=s.id}},[f(k)],8,Ne))])),h.shared?_("",!0):(a(),r("td",Oe,[e("button",{onClick:p=>i.removeChecklist(s.id),"data-cy":"deleteTrip"},[f(x,{class:"text-red-600 hover:text-red-800"})],8,Le)]))],2))),128))])):_("",!0)]),e("div",Te,[!h.shared&&!h.checklists?(a(),r("a",{key:0,onClick:u[3]||(u[3]=s=>i.addChecklist()),class:"text-neutral-500 hover:cursor-pointer"},n(c.$t("trips.createNew")),1)):h.shared&&!h.checklists.sharedChecklists?(a(),r("p",Je,n(c.$t("trips.noShared")),1)):_("",!0)]),e("div",Pe,[(a(!0),r(I,null,S(h.checklists,s=>(a(),r("div",{key:s.id,class:"bg-green50 mb-4 rounded-md md:mx-24"},[e("div",je,[e("div",qe,[f(b,{to:`/trips/${s.id}`},{default:N(()=>[e("p",Ae,n(s.name),1)]),_:2},1032,["to"]),e("p",Ge,n(s.description),1)]),e("p",Ve,n(`${i.totalofItemsCheckedInCategory(s.categories)}/${i.totalItemsInCategory(s.categories)}`),1)]),e("div",Be,[e("div",ze,[f(U,{class:"",to:`/carpool/${s.id}`},{default:N(()=>[e("button",null,[f(F,{class:"h-8 w-8"})])]),_:2},1032,["to"]),h.shared?_("",!0):(a(),r("button",{key:0,onClick:y=>{i.clickShare=!0,i.checklistId=s.id}},[f(k,{class:"h-7 w-7"})],8,Ee)),e("button",{onClick:y=>i.removeChecklist(s.id)},[f(x,{class:"h-7 w-7 text-red-600 hover:text-red-800"})],8,Re)])])]))),128))]),h.shared?_("",!0):(a(),r("button",{key:1,"data-cy":"createChecklist",onClick:u[4]||(u[4]=s=>i.addChecklist()),class:"bg-greenPrimary hover:bg-green700 mt-4 mb-8 ml-auto mr-0 flex w-max rounded-full md:py-3 md:px-3"},[e("div",Xe,[f(L,{class:"h-8 w-8 md:h-6 md:w-6"}),e("p",De,n(c.$t("trips.createNew")),1)])]))],64)}const lt=E($,[["render",He]]);export{lt as C};
